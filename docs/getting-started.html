<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>快速上手 - WeChatAuto.SDK</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <!-- 侧边栏 -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <h1>WeChatAuto.SDK</h1>
        <p>微信自动化开发框架</p>
      </div>
      <nav class="sidebar-nav">
        <div class="nav-item">
          <a href="index.html">简介</a>
        </div>
        <div class="nav-group">开始</div>
        <div class="nav-item">
          <a href="getting-started.html" class="active">快速上手</a>
        </div>
        <div class="nav-group">指南</div>
        <div class="nav-item">
          <a href="basics.html">基础使用</a>
        </div>
        <div class="nav-group">API</div>
        <div class="nav-item">
          <a href="api.html">组件 API</a>
        </div>
      </nav>
    </aside>

    <!-- 主内容 -->
    <main class="main-content">
      <h1>快速上手</h1>
      
      <p>本指南将帮助你快速开始使用 WeChatAuto.SDK 进行微信自动化开发。</p>

      <h2>安装</h2>
      
      <h3>1. 环境要求</h3>
      <ul>
        <li>Windows 10/11 操作系统</li>
        <li>.NET SDK 6.0 或更高版本（或 .NET Framework 4.8+）</li>
        <li>微信 PC 客户端（已安装并可以正常使用）</li>
      </ul>

      <h3>2. 添加项目引用</h3>
      <p>在你的项目中添加对 WeChatAuto 的引用：</p>
      
      <div class="code-title">项目文件 (.csproj)</div>
      <pre><code class="language-xml">&lt;ItemGroup&gt;
  &lt;ProjectReference Include="..\WeChatAuto\WeChatAuto.csproj" /&gt;
&lt;/ItemGroup&gt;</code></pre>

      <h3>3. 安装 NuGet 包</h3>
      <p>WeChatAuto 会自动引入所需的依赖包，包括：</p>
      <ul>
        <li>FlaUI.Core / FlaUI.UIA3</li>
        <li>Microsoft.Extensions.DependencyInjection</li>
        <li>Microsoft.Extensions.Logging</li>
        <li>Newtonsoft.Json</li>
      </ul>

      <h2>第一个示例</h2>
      
      <p>让我们创建一个简单的控制台应用程序，实现发送微信消息的功能：</p>

      <div class="code-title">Program.cs</div>
      <pre><code class="language-csharp">using Microsoft.Extensions.DependencyInjection;
using Microsoft.Extensions.Logging;
using WeChatAuto.Components;
using WeChatAuto.Services;

class Program
{
    static async Task Main(string[] args)
    {
        // 1. 创建服务集合
        var services = new ServiceCollection();
        
        // 2. 配置日志
        services.AddLogging(builder => 
        {
            builder.AddConsole();
            builder.SetMinimumLevel(LogLevel.Information);
        });
        
        // 3. 初始化微信自动化框架
        WeAutomation.Initialize(services, options =>
        {
            options.DebugMode = true;
            options.EnableRecordVideo = false;
        });
        
        // 4. 构建服务提供者
        var serviceProvider = services.BuildServiceProvider();
        
        // 5. 获取微信客户端工厂
        var factory = serviceProvider.GetRequiredService&lt;WeChatClientFactory&gt;();
        
        // 6. 获取所有微信客户端名称
        var clientNames = factory.GetWxClientNames();
        if (clientNames.Count == 0)
        {
            Console.WriteLine("未找到微信客户端，请先打开微信");
            return;
        }
        
        Console.WriteLine($"找到 {clientNames.Count} 个微信客户端：");
        foreach (var name in clientNames)
        {
            Console.WriteLine($"  - {name}");
        }
        
        // 7. 获取第一个微信客户端
        var client = factory.GetWeChatClient(clientNames[0]);
        Console.WriteLine($"当前使用微信：{client.NickName}");
        
        // 8. 发送消息
        try
        {
            await client.SendWho("好友名称", "你好，这是一条测试消息！");
            Console.WriteLine("消息发送成功！");
        }
        catch (Exception ex)
        {
            Console.WriteLine($"发送失败：{ex.Message}");
        }
        
        // 9. 清理资源
        factory.Dispose();
    }
}</code></pre>

      <div class="alert alert-warning">
        <strong>注意：</strong> 运行前请确保微信 PC 客户端已打开，并且"好友名称"确实存在于你的微信联系人中。
      </div>

      <h2>配置选项</h2>
      
      <p>在初始化时，可以通过配置选项自定义框架行为：</p>

      <pre><code class="language-csharp">WeAutomation.Initialize(services, options =>
{
    // 调试模式：输出详细的调试信息
    options.DebugMode = true;
    
    // 启用鼠标键盘模拟器（需要硬件支持）
    options.EnableMouseKeyboardSimulator = false;
    
    // 启用操作视频录制（用于调试）
    options.EnableRecordVideo = true;
    
    // 启用应用运行检查
    options.EnableCheckAppRunning = true;
    
    // 截图保存路径
    options.CaptureUIPath = @"C:\Screenshots";
    
    // 视频保存路径
    options.TargetVideoPath = @"C:\Videos";
    
    // 消息监听间隔（秒）
    options.ListenInterval = 1;
});</code></pre>

      <h2>常见场景示例</h2>

      <h3>场景 1：发送消息给多个好友</h3>
      <pre><code class="language-csharp">var client = factory.GetWeChatClient("微信昵称");
var friends = new[] { "好友1", "好友2", "好友3" };
await client.SendWhos(friends, "这是一条群发消息");</code></pre>

      <h3>场景 2：群聊中@用户</h3>
      <pre><code class="language-csharp">var client = factory.GetWeChatClient("微信昵称");
// 在群聊中发送消息并@指定用户
await client.SendWho("群聊名称", "请查看重要通知", "被@的用户");</code></pre>

      <h3>场景 3：获取聊天记录</h3>
      <pre><code class="language-csharp">var client = factory.GetWeChatClient("微信昵称");
// 获取最近10页的聊天记录
var history = client.GetChatAllHistory("好友或群聊名称", pageCount: 10);

foreach (var message in history)
{
    Console.WriteLine($"[{message.Time}] {message.SenderName}: {message.Content}");
}</code></pre>

      <h3>场景 4：监听新消息</h3>
      <pre><code class="language-csharp">var client = factory.GetWeChatClient("微信昵称");
client.FindAndOpenFriendOrGroup("好友名称");

var chatContent = client.WxMainWindow.MainChatContent;
var chatBody = chatContent.ChatBody;

// 添加消息监听
chatBody.AddListener(messageContext =>
{
    foreach (var newMessage in messageContext.NewMessages)
    {
        Console.WriteLine($"收到新消息：{newMessage.MessageContent}");
        
        // 自动回复示例
        if (newMessage.MessageContent.Contains("你好"))
        {
            messageContext.Sender.SendMessage("你好！");
        }
    }
});

// 保持程序运行
Console.WriteLine("正在监听消息，按任意键退出...");
Console.ReadKey();

// 停止监听
chatBody.StopListener();</code></pre>

      <h2>使用 MCP Server</h2>
      
      <p>WeChatAuto.SDK 提供了 MCP Server 实现，可以与 AI 工具集成：</p>

      <h3>1. 启动 MCP Server</h3>
      <pre><code class="language-bash">cd WeChatAuto.MCP
dotnet run</code></pre>

      <h3>2. 配置 Claude Desktop</h3>
      <p>在 Claude Desktop 的配置文件中添加：</p>
      <pre><code class="language-json">{
  "mcpServers": {
    "wechat-auto": {
      "command": "dotnet",
      "args": [
        "D:/path/to/WeChatAuto.MCP/bin/Debug/net10.0-windows/WeChatAuto.MCP.dll"
      ]
    }
  }
}</code></pre>

      <h3>3. 在 AI 工具中使用</h3>
      <p>配置完成后，你可以在 Claude Desktop 或 Cursor 中通过自然语言使用微信自动化功能：</p>
      <blockquote>
        "请帮我发送一条消息给张三，内容是'你好'"
      </blockquote>

      <h2>下一步</h2>
      <p>
        现在你已经了解了基本用法，可以继续阅读：
      </p>
      <ul>
        <li><a href="basics.html">基础使用</a> - 深入了解 UI 自动化原理和常用操作</li>
        <li><a href="api.html">组件 API</a> - 查看完整的 API 文档</li>
      </ul>
    </main>
  </div>
</body>
</html>

